<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏—ë–º–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Font Awesome –¥–ª—è –∏–∫–æ–Ω–æ–∫ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 600px;
            width: 90%;
            background-color: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 32px;
            font-weight: 600;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 15px;
        }
        
        h1 i {
            color: #4CAF50;
            margin-right: 10px;
        }
        
        .menu-section {
            margin-bottom: 30px;
        }
        
        .menu-section h2 {
            color: #666;
            font-size: 18px;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 4px solid #4CAF50;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn i {
            font-size: 18px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        /* –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ */
        .btn-green {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }
        
        .btn-blue {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }
        
        .btn-orange {
            background: linear-gradient(135deg, #FF9800, #F57C00);
        }
        
        .btn-red {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }
        
        .btn-purple {
            background: linear-gradient(135deg, #9C27B0, #7B1FA2);
        }
        
        .btn-teal {
            background: linear-gradient(135deg, #009688, #00796B);
        }
        
        .btn-indigo {
            background: linear-gradient(135deg, #3F51B5, #303F9F);
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #ddd;
        }
        
        .action-btn {
            flex: 1;
            padding: 18px;
            font-size: 18px;
        }
        
        .footer-note {
            text-align: center;
            margin-top: 25px;
            color: #999;
            font-size: 14px;
        }
        
        .footer-note i {
            color: #f44336;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
            text-align: center;
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-icon {
            font-size: 48px;
            color: #f44336;
            margin-bottom: 20px;
        }
        
        .modal h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .modal p {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .modal-btn.confirm {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }
        
        .modal-btn.cancel {
            background: linear-gradient(135deg, #9e9e9e, #757575);
            color: white;
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            animation: slideInRight 0.3s ease-out;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .notification.success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }
        
        .notification.info {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .fade-out {
            animation: fadeOut 0.3s ease-out forwards;
        }
        
        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateX(50px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <i class="fas fa-university"></i>
            –ü—Ä–∏—ë–º–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è 2026
        </h1>
        
        <!-- –û—Ç—á—ë—Ç—ã -->
        <div class="menu-section">
            <h2><i class="fas fa-chart-bar"></i> –û—Ç—á—ë—Ç—ã</h2>
            <div class="button-grid">
                <a href="/all_students" class="btn btn-purple">
                    <i class="fas fa-chart-pie"></i>
                    –°–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç
                </a>
                <a href="/vse_spiski" class="btn btn-teal">
                    <i class="fas fa-list"></i>
                    –í—Å–µ –∫–æ–Ω–∫—É—Ä—Å–Ω—ã–µ —Å–ø–∏—Å–∫–∏
                </a>
            </div>
        </div>
        
        <!-- –ö–æ–Ω–∫—É—Ä—Å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º -->
        <div class="menu-section">
            <h2><i class="fas fa-graduation-cap"></i> –ö–æ–Ω–∫—É—Ä—Å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º</h2>
            <div class="button-grid">
                <a href="/pm_students" class="btn btn-green">
                    <i class="fas fa-calculator"></i>
                    –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–ü–ú)
                </a>
                <a href="/ivt_students" class="btn btn-blue">
                    <i class="fas fa-laptop-code"></i>
                    –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏ –í–¢ (–ò–í–¢)
                </a>
                <a href="/itss_students" class="btn btn-orange">
                    <i class="fas fa-network-wired"></i>
                    –ò–Ω—Ñ–æ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–ò–¢–°–°)
                </a>
                <a href="/ib_students" class="btn btn-red">
                    <i class="fas fa-shield-alt"></i>
                    –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ò–ë)
                </a>
            </div>
        </div>
        
        <!-- –î–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö -->
        <div class="action-buttons">
            <button onclick="showAddListModal()" class="btn btn-indigo action-btn">
                <i class="fas fa-plus-circle"></i>
                –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
            </button>
            <button onclick="showClearDBModal()" class="btn btn-red action-btn">
                <i class="fas fa-trash-alt"></i>
                –û—á–∏—Å—Ç–∏—Ç—å –ë–î
            </button>
        </div>
        
        <div class="footer-note">
            <i class="fas fa-info-circle"></i>
            –í—Å–µ–≥–æ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ: <span id="totalStudents">0</span>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
    <div id="addListModal" class="modal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-file-import" style="color: #2196F3;"></i>
            </div>
            <h3>–î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤</h3>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.</p>
            <p style="font-size: 14px; color: #666; margin-top: -10px;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç: CSV (–Ω–∞–ø—Ä–∏–º–µ—Ä: 01.08_–ò–ë.csv)</p>
            <input type="file" id="fileInput" accept=".csv" style="margin-bottom: 20px; padding: 10px; border: 2px dashed #ddd; border-radius: 8px; width: 100%; box-sizing: border-box;">
            <div class="modal-buttons">
                <button onclick="uploadFile()" class="modal-btn confirm">
                    <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å
                </button>
                <button onclick="closeModal('addListModal')" class="modal-btn cancel">
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ë–î -->
    <div id="clearDBModal" class="modal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3>–û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö?</h3>
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å <strong>–í–°–ï–•</strong> –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!</p>
            <div class="modal-buttons">
                <button onclick="clearDatabase()" class="modal-btn confirm">
                    <i class="fas fa-trash"></i> –î–∞, –æ—á–∏—Å—Ç–∏—Ç—å
                </button>
                <button onclick="closeModal('clearDBModal')" class="modal-btn cancel">
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                ${message}
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞
        function showAddListModal() {
            showModal('addListModal');
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—á–∏—Å—Ç–∫–∏ –ë–î
        function showClearDBModal() {
            showModal('clearDBModal');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CSRF —Ç–æ–∫–µ–Ω–∞ –∏–∑ –∫—É–∫–∏
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
            if (!file.name.toLowerCase().endsWith('.csv')) {
                showNotification('–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (DD.MM_–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï.csv)
            const filenamePattern = /^\d{2}\.\d{2}_(–ü–ú|–ò–í–¢|–ò–¢–°–°|–ò–ë)\.csv$/;
            if (!filenamePattern.test(file.name)) {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞. –û–∂–∏–¥–∞–µ—Ç—Å—è: DD.MM_–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï.csv (–Ω–∞–ø—Ä–∏–º–µ—Ä: 01.08_–ò–ë.csv)', 'error');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º FormData –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞
            const formData = new FormData();
            formData.append('file', file);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...', 'info');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            fetch('/api/upload-students/', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': getCookie('csrftoken')
                }
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.error || `HTTP error! status: ${response.status}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    let message = data.message;
                    if (data.statistics) {
                        message = `‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!\n`;
                        message += `üìä –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ${data.statistics.processed}\n`;
                        message += `‚ú® –°–æ–∑–¥–∞–Ω–æ: ${data.statistics.created}\n`;
                        message += `üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ: ${data.statistics.updated}`;
                        
                        if (data.statistics.errors > 0) {
                            message += `\n‚ö†Ô∏è –û—à–∏–±–æ–∫: ${data.statistics.errors}`;
                        }
                    }
                    showNotification(message, 'success');
                    
                    // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö –≤ –∫–æ–Ω—Å–æ–ª–∏
                    if (data.errors && data.errors.length > 0) {
                        console.warn('–û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ:');
                        data.errors.forEach(error => console.warn(error));
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –æ—à–∏–±–∫—É –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
                        showNotification('–ü–µ—Ä–≤–∞—è –æ—à–∏–±–∫–∞: ' + data.errors[0], 'error');
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å
                    setTimeout(() => {
                        updateTotalStudents();
                        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ debug endpoint
                        fetch('/api/debug-students/')
                            .then(res => res.json())
                            .then(debugData => {
                                console.log('–°—Ç—É–¥–µ–Ω—Ç—ã –≤ –ë–î –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:', debugData);
                            });
                    }, 500);
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞', 'error');
                }
            })
            .catch(error => {
                showNotification('–û—à–∏–±–∫–∞: ' + error.message, 'error');
                console.error('Upload error:', error);
            })
            .finally(() => {
                closeModal('addListModal');
                fileInput.value = ''; // –û—á–∏—â–∞–µ–º input
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        function clearDatabase() {
            fetch('/api/clear-database/', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': getCookie('csrftoken'),
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    showNotification(data.message, 'success');
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –ë–î', 'error');
                }
            })
            .catch(error => {
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –ë–î: ' + error.message, 'error');
                console.error('Clear DB error:', error);
            })
            .finally(() => {
                closeModal('clearDBModal');
                updateTotalStudents(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤
        function updateTotalStudents() {
            fetch('/api/total-students/')
                .then(response => response.json())
                .then(data => {
                    if (data.total !== undefined) {
                        document.getElementById('totalStudents').textContent = data.total;
                    } else {
                        document.getElementById('totalStudents').textContent = '0';
                    }
                })
                .catch(error => {
                    console.error('Error fetching total students:', error);
                    document.getElementById('totalStudents').textContent = '?';
                });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            updateTotalStudents();
        });
    </script>
</body>
</html>